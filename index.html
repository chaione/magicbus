<!DOCTYPE html>
<!-- <meta http-equiv="refresh" content="5" > -->
<html>
<head>
  <title>Page Title</title>
  <link rel="stylesheet" href="css/styles.css">
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://www.parsecdn.com/js/parse-latest.js"></script>
</head>

<body>
  <!-- <img src="images/C1-Logo.png" class="logo" alt=""> -->

  <div class="header">
    <div class="headerImg">
      <img src="images/Header-Image.png" alt="">      
    </div>

    <div class="hr1"></div>
    <div class="hr2"></div>
  </div>
  <div id="gallery" class="photos">
    
  </div>

  <script type="text/javascript">
    Parse.initialize("iB2vRc9kAu3qgdvmfMfwgNcns5tnPqMNZqEli6om",
                     "jhDM78h8afoa5lIBgHkvleovABpOEzvLWxdGpiCA");
    


    var currentPhotos = [];

    console.log('hi');
    var GameScore = Parse.Object.extend("GIF");
    var query = new Parse.Query(GameScore);
    query.find({
        success:function(photos){
            console.log(photos);
            var imageLoadCount = Math.min(photos.length,30);

            for (var i = photos.length-1; i >= photos.length-imageLoadCount; i--) {
              console.log('photo', photos[i]);
              var photo = photos[i];
              currentPhotos.push(photo.id);

              document.getElementById('gallery').innerHTML +=
                '<img class="photo" style="width:200px;" src="' + photo.attributes.gif._url + '"></img>';
            };

            // $.each(items,function(i,item){
            //   document.getElementById('gallery').innerHTML +=
            //     '<img class="photo" style="width:200px;" src="' + item.attributes.gif._url + '"></img>';
            // });
        //     $.each(items,function(i,item){
        //     alert(i+":"+JSON.stringify(item));});
        // }
      }
    });

   var timeout = setInterval(dance,5000);
    function dance(){
      console.log('dance');
      query.find({
         success:function(photos){
            console.log(photos);
            var imageLoadCount = Math.min(photos.length,30);
            for (var i = photos.length-1; i >= photos.length-imageLoadCount; i--) {
              var photo = photos[i];

              if($.inArray(photo.id, currentPhotos) === -1){
                console.log('not in');
                console.log(photo.id);
                console.log(currentPhotos);
                currentPhotos.push(photo.id);

                document.getElementById('gallery').innerHTML =
                  '<img class="photo" style="width:200px;" src="' + photo.attributes.gif._url + '"></img>' + document.getElementById('gallery').innerHTML;
              }{
                console.log('already in');
              }
              
              
            }

       }
     });
  }
  </script>
  <script type="text/javascript">
  //   var currentETags = [];
  //   var bucket = new AWS.S3({params: {Bucket: 'marketing-gifbomb'}});

  //   AWS.config.credentials = bucket.config.update({accessKeyId: 'AKIAJMSZ2RX2EK2RNJWQ', secretAccessKey: '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'});
  //   bucket.listObjects(function (err, data) {
  //     console.log(data);
  //     if (err) {
  //         console.log(err);
  //         console.log(data);
  //     } else {
  //       // var currentDocs = data.Contents.map.;
  //       var imageLoadCount = Math.min(data.Contents.length,20);
  //       for (var i = data.Contents.length-1; i >= data.Contents.length-imageLoadCount; i--) {
  //         var image = data.Contents[i];
  //         console.log("https://s3.amazonaws.com/marketing-gifbomb/" + image.Key);
  //         currentETags = currentETags.push(image.ETag);
  //         console.log('etag:',image.ETag);
  //         document.getElementById('gallery').innerHTML +=
  //           '<img class="photo" style="width:200px;" src="https://s3.amazonaws.com/marketing-gifbomb/' + data.Contents[i].Key + '"></img>';
  //           document.getElementById('gallery').innerHTML +=
  //           '<img class="photo" style="width:200px;" src="https://s3.amazonaws.com/marketing-gifbomb/' + data.Contents[i].Key + '"></img>';
  //           document.getElementById('gallery').innerHTML +=
  //           '<img class="photo" style="width:200px;" src="https://s3.amazonaws.com/marketing-gifbomb/' + data.Contents[i].Key + '"></img>';
  //           document.getElementById('gallery').innerHTML +=
  //           '<img class="photo" style="width:200px;" src="https://s3.amazonaws.com/marketing-gifbomb/' + data.Contents[i].Key + '"></img>';
  //           document.getElementById('gallery').innerHTML +=
  //           '<img class="photo" style="width:200px;" src="https://s3.amazonaws.com/marketing-gifbomb/' + data.Contents[i].Key + '"></img>';
  //           document.getElementById('gallery').innerHTML +=
  //           '<img class="photo" style="width:200px;" src="https://s3.amazonaws.com/marketing-gifbomb/' + data.Contents[i].Key + '"></img>';
  //           document.getElementById('gallery').innerHTML +=
  //           '<img class="photo" style="width:200px;" src="https://s3.amazonaws.com/marketing-gifbomb/' + data.Contents[i].Key + '"></img>';
  //           document.getElementById('gallery').innerHTML +=
  //           '<img class="photo" style="width:200px;" src="https://s3.amazonaws.com/marketing-gifbomb/' + data.Contents[i].Key + '"></img>';
  //       }
        
  //       console.log(currentETags);
  //       console.log(currentETags[0]);
  //     }
  //   });


 

  // </script>
</body>
</html>

